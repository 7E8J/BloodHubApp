generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum BloodType {
  A_POSITIVE
  B_POSITIVE
  O_POSITIVE
  AB_POSITIVE
  A_NEGATIVE
  B_NEGATIVE
  O_NEGATIVE
  AB_NEGATIVE
}

enum Prefix {
  Mr
  Ms
  Mrs
}

enum Gender {
  MALE
  FEMALE
}

model User {
  id           String   @id @default(cuid())
  citizenId    String   @unique
  citizenBack  String   @unique
  profileImage String?
  prefix       String
  firstName    String
  lastName     String
  email        String   @unique
  phoneNumber  String   @unique
  password     String
  bloodType    String
  dob          DateTime
  gender       String
  weight       Float?
  height       Float
  disease      String?
  created_at   DateTime @default(now())
  updated_at   DateTime @updatedAt

  addressId    String   @unique
  address      Address  @relation(fields: [addressId], references: [id])
  donationHistory DonationHistory[]
  post         Post[]
}


// แก้ relation
model Address {
  id          String  @id @default(cuid())
  houseNo     String
  moo         String
  soi         String
  subDistrict String?
  district    String?
  province    String?
  country     String?
  postcode    String?

  user        User?
}

enum caseType {
  NORMAL
  EMERGENCY
}

// ไม่มีรูปภาพให้เก็บ
model News {
  id          String   @id @unique @default(cuid())
  title       String
  description String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  deleted_at  DateTime
}

// แก้ relation appointment_id
model Post {
  id           String     @id @unique @default(cuid())
  image        String?
  description  String?
  phone_number String?    @unique
  bloodType    BloodType?
  case         caseType?
  userId       String     @unique
  user         User      @relation(fields: [userId], references: [id])
  // appointment_id Appointment[]
}


enum AppointmentStatus {
  Pending
  Completed
  Cancelled
}

// model Appointment {
//   id                  String            @id @unique @default(cuid())
//   status              AppointmentStatus
//   created_at          DateTime          @default(now())
//   cancelled_at        DateTime?
//   reservation_slot_id String            @unique
//   donator_id          String

//   postId String @unique
//   post Post @relation(fields: [postId], references: [id])
// }


// แก้เป็นแต่ละ โรงพยายาบาล หรือ ทำ relation แต่ละโรงบาล

model Hospital {
  id             String   @id @default(cuid())
  hospitalName   String
  hospitalImg    String
  bloodNeed      BloodNeed?
}

model BloodNeed {
  id                 String   @id @default(cuid())
  aPositiveNeed      Int
  bPositiveNeed      Int
  oPositiveNeed      Int
  abPositiveNeed     Int
  aPositiveReceive   String
  bPositiveReceive   String
  oPositiveReceive   String
  abPositiveReceive  String
  aNegativeNeed      Int
  bNegativeNeed      Int
  oNegativeNeed      Int
  abNegativeNeed     Int
  hospitalId         String   @unique
  hospital           Hospital @relation(fields: [hospitalId], references: [id])
}


enum DonationStatus {
  PENDING
  APPOINTED
  DENIED
}

model DonationHistory {
  id         String         @id @default(cuid())
  blood_type BloodType
  status     DonationStatus
  created_at DateTime       @default(now())
  updated_at DateTime?
  deleted_at DateTime?

  userId String
  user User @relation(fields: [userId], references: [id])
}
